/*!
  ArtboardJS v1.1.0
  (c) 2017 Depth Development. http://depthdev.com
  License: MIT
!*/
!function(e,t){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};e.Artboard=function(){function i(e){e.preventDefault(),e.stopPropagation(),S=0,b=0;for(var t=m;t;)S+=t.offsetTop,b+=t.offsetLeft,t=t.offsetParent}function n(e){P=[],C=[];for(var t=0,i=e.length;t<i;t++)P.push(e[t].pageX-b),C.push(e[t].pageY-S)}function o(e){e.preventDefault(),e.stopPropagation(),O.isPlaying||(i(e),n(e.touches),O.createEntry(),A(),O.rewrite())}function l(e){e.preventDefault(),e.stopPropagation(),O.isPlaying||(n(e.touches),A())}function r(e){e.preventDefault(),e.stopPropagation(),O.isPlaying||(D=!0,i(e),P=[e.pageX-b],C=[e.pageY-S],O.createEntry(),A(),O.rewrite())}function a(e){e.preventDefault(),e.stopPropagation(),O.isPlaying||D&&(P=[e.pageX-b],C=[e.pageY-S],A())}function u(e){D&&(D=!1,e.preventDefault(),e.stopPropagation())}function h(e){if(!O.isPlaying){var i=e||{};m.width=i.width||t.documentElement.clientWidth,m.height=i.height||m.width*(9/16),_.clearRect(0,0,m.width,m.height),p=i.multiTouch!==!1,v=i.rainbow!==!1,_.fillStyle=i.color||"#000000",_.shadowColor=_.fillStyle,_.shadowBlur=i.glow>=0?i.glow:10,T=0,E=i.radius>=0?i.radius:10,B=i.done||function(){},O.timeline=[]}}function s(e){if(!O.isPlaying){var t={multiTouch:p,rainbow:v,color:_.fillStyle,glow:_.shadowBlur,degree:T,radius:E,done:B},i=e||{};m.width=i.width||m.width,m.height=i.height||m.height,_.clearRect(0,0,m.width,m.height),O.timeline=[],p=t.multiTouch,v=t.rainbow,_.fillStyle=t.color,_.shadowColor=_.fillStyle,_.shadowBlur=t.glow,T=t.degree,E=t.radius,B=t.done}}function d(){O.isPlaying||(_.clearRect(0,0,m.width,m.height),O.timeline=[])}function g(e){if(!O.isPlaying){var t=e||{};p=void 0!==t.multiTouch?t.multiTouch:p,v=void 0!==t.rainbow?t.rainbow:v,_.fillStyle=t.color||_.fillStyle,_.shadowColor=_.fillStyle,_.shadowBlur=t.glow>=0?t.glow:_.shadowBlur,E=t.radius>=0?t.radius:E,B=t.done||B}}function c(e){this.a=t.createElement("a"),this.a.href=m.toDataURL("image/png"),this.a.download=e||"ArtboardJS",this.a.click(),delete this.a}function f(){O.timeline=[],m.removeEventListener("touchstart",o),m.removeEventListener("touchmove",l),m.removeEventListener("mousedown",r),m.removeEventListener("mousemove",a),t.removeEventListener("mouseup",u)}var m=arguments[0],w="object"===_typeof(arguments[1])&&arguments[1];if(!m.getContext){var y=arguments[arguments.length-1];return"function"==typeof y&&y(),!1}var p=!0,v=!0,S=0,b=0,P=[],C=[],E=10,L=2*Math.PI,T=0,B=null,_=m.getContext("2d");_.fillStyle="#000000",_.shadowColor="#000000",_.shadowOffsetX=0,_.shadowOffsetY=0,_.shadowBlur=10;var A=null,D=!1,O={timeline:[],createEntry:function(){O.timeline.push([])},undoCount:0,save:function(){e.localStorage.artboard=JSON.stringify({width:m.width,height:m.height,timeline:O.timeline})},saveAs:function(t,i){return/^[a-zA-Z0-9_$]+$/.test(t)?(e.localStorage["artboard_"+t]=JSON.stringify({width:m.width,height:m.height,timeline:O.timeline}),!i||i(!0)):!!i&&i(!1)},saved:function(){var t=[];for(var i in e.localStorage)/^artboard_/.test(i)&&t.push(i.replace(/^artboard_/,""));return t},backup:function(){return{width:m.width,height:m.height,timeline:O.timeline}},restore:function(t,i){if(!t||t instanceof Event){if(e.localStorage.artboard){var n=JSON.parse(e.localStorage.artboard);return m.width=n.width,m.height=n.height,O.timeline=n.timeline,O.undoCount=0,O.change(),!i||i(!0)}return!!i&&i(!1)}if("string"==typeof t){if(e.localStorage["artboard_"+t]){var o=JSON.parse(e.localStorage["artboard_"+t]);return m.width=o.width,m.height=o.height,O.timeline=o.timeline,O.undoCount=0,O.change(),!i||i(!0)}return!!i&&i(!1)}try{return m.width=t.width,m.height=t.height,O.timeline=t.timeline,O.undoCount=0,O.change(),!i||i(!0)}catch(l){return!!i&&i(!1)}},deleteSaved:function(){delete e.localStorage.artboard;for(var t in e.localStorage)/^artboard_/.test(t)&&delete e.localStorage[t]},rewrite:function(){O.undoCount&&(O.timeline.splice(O.timeline.length-1-O.undoCount,O.undoCount),O.undoCount=0)},log:function(){O.timeline[O.timeline.length-1].push({multiTouch:p,rainbow:v,color:_.fillStyle,x:P,y:C,radius:E,degree:T,glow:_.shadowBlur})},settings:function(){return{multiTouch:p,rainbow:v,color:_.fillStyle,radius:E,degree:T,glow:_.shadowBlur}},change:function(){_.clearRect(0,0,m.width,m.height);for(var e=0,t=0,i=O.timeline.length-O.undoCount,n=O.timeline[e].length;e<i;e++)for(t=0,n=O.timeline[e].length;t<n;t++)p=O.timeline[e][t].multiTouch,v=O.timeline[e][t].rainbow,_.fillStyle=O.timeline[e][t].color,P=O.timeline[e][t].x,C=O.timeline[e][t].y,E=O.timeline[e][t].radius,T=O.timeline[e][t].degree,_.shadowBlur=O.timeline[e][t].glow,_.shadowColor=_.fillStyle,A(!0);B()},undo:function(){O.undoCount!==O.timeline.length&&(O.undoCount++,O.change())},redo:function(){O.undoCount>0&&(O.undoCount--,O.change())},stopPlaying:!1,isPlaying:!1,play:function(){function t(){return p=O.timeline[i][n].multiTouch,v=O.timeline[i][n].rainbow,_.fillStyle=O.timeline[i][n].color,P=O.timeline[i][n].x,C=O.timeline[i][n].y,E=O.timeline[i][n].radius,T=O.timeline[i][n].degree,_.shadowBlur=O.timeline[i][n].glow,_.shadowColor=_.fillStyle,A(!0),n++,O.stopPlaying?void(O.stopPlaying=!1):void(n===l?i+1!==o?(i++,n=0,l=O.timeline[i].length,e.requestAnimationFrame(t)):(O.stopPlaying=!1,O.isPlaying=!1,B()):e.requestAnimationFrame(t))}if(O.timeline.length){O.isPlaying=!0,_.clearRect(0,0,m.width,m.height);var i=0,n=0,o=O.timeline.length,l=O.timeline[i].length;t()}},stop:function(){O.stopPlaying=!0,e.setTimeout(function(){O.isPlaying=!1,O.stopPlaying=!1,O.change()},100)},size:function(){return JSON.stringify({width:m.width,height:m.height,timeline:O.timeline}).length}};return A=function(e){v&&(_.fillStyle="hsl("+T+",100%,50%)",_.shadowColor="hsl("+T+",100%,50%)",T++);for(var t=0,i=P.length;t<i&&(_.beginPath(),_.arc(P[t],C[t],E,0,L,!1),_.fill(),p);t++);e||O.log()},m.addEventListener("touchstart",o),m.addEventListener("touchmove",l),m.addEventListener("mousedown",r),m.addEventListener("mousemove",a),t.addEventListener("mouseup",u),h(w),{adjust:g,backup:O.backup,clear:d,deleteSaved:O.deleteSaved,destroy:f,hardReset:h,image:c,play:O.play,redo:O.redo,reset:s,restore:O.restore,save:O.save,saveAs:O.saveAs,saved:O.saved,settings:O.settings,size:O.size,stop:O.stop,undo:O.undo}}}(window,document);